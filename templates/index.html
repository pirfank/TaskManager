<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Task Manager</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body class="dark">

<div id="app"
     class="app-container"
     data-nickname="{{ nickname }}">

  <h1>Welcome, {{ nickname }} ğŸ‘‹</h1>

  <!-- SYSTEM CONTROLS -->
  <div class="card center system-controls">
    <button class="btn neon large" onclick="enableNotifications()">
      ğŸ”” Enable Voice & Notifications
    </button>

    <form method="POST" action="/logout">
      <button class="btn ghost logout">Logout</button>
    </form>
  </div>

  <!-- ADD TASK -->
  <div class="card">
    <h2>Add New Task</h2>

    <form method="POST">
      <input name="content" placeholder="Task..." maxlength="500" required>
      <input type="datetime-local" name="due_time" required>
      <button class="btn primary">Add</button>
    </form>
  </div>

  <!-- TASK LIST -->
  <div class="card">
    <h2>Your Tasks</h2>

    {% for task in tasks %}
      <div class="task {% if task.completed %}done{% endif %}"
           data-task="{{ task.content }}"
           data-due="{{ task.due_time.isoformat() }}">

        <div class="task-info">
          <strong>{{ task.content }}</strong>
          <small>{{ task.due_time.strftime("%d %b %Y, %H:%M") }}</small>
        </div>

        <div class="actions">
          <a href="/update/{{ task.id }}" class="btn icon edit" title="Edit">
            âœï¸
          </a>

          <a href="/complete/{{ task.id }}" class="btn icon success" title="Done">
            {% if task.completed %}â†©ï¸{% else %}âœ”ï¸{% endif %}
          </a>

          <a href="/delete/{{ task.id }}" class="btn icon danger" title="Delete">
            ğŸ—‘ï¸
          </a>
        </div>
      </div>
    {% else %}
      <p class="center">No tasks yet ğŸš€</p>
    {% endfor %}
  </div>

</div>

<script src="{{ url_for('static', filename='js/notify.js') }}"></script>
</body>
</html>
